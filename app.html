<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lịch Công Tác Tuần - Dữ Liệu Tĩnh</title>
    <!-- Tải Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Thiết lập font cho toàn bộ ứng dụng */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f7f9;
        }
        /* Đảm bảo các hàng không có nền mặc định trước khi JS gán */
        .table-auto tr {
            background-color: transparent; 
        }
        /* Style cho ô tiêu đề - Màu xanh đậm tương tự bảng tính */
        .table-auto th {
            /* Đảm bảo các class Tailwind được áp dụng */
            @apply px-3 py-3 text-left text-xs font-semibold uppercase tracking-wider; 
            background-color: #3b82f6; /* Blue-500 */
            color: white;
            border-bottom: 2px solid #1e40af; /* Darker blue line */
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- Container chính chiếm 100% chiều rộng --><div class="w-full mx-auto bg-white shadow-xl rounded-2xl p-6 md:p-10">
        <h1 class="text-3xl font-extrabold text-gray-800 mb-6 border-b pb-4">
            Lịch Công Tác Tuần (Dữ Liệu Mẫu)
        </h1>

        <!-- Thanh Tìm Kiếm --><div class="flex flex-col gap-4 mb-8">
            <input type="text" id="searchInput" placeholder="Tìm kiếm theo Nội dung chính hoặc Nội dung chi tiết..."
                   class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 shadow-sm">
        </div>

        <!-- Khu vực hiển thị bảng dữ liệu (Cho phép cuộn ngang trên màn hình nhỏ) -->
        <div class="overflow-x-auto shadow-md rounded-xl border border-gray-200">
            <table class="min-w-full divide-y divide-gray-200 border-collapse">
                <thead class="sticky top-0">
                    <tr>
                        <th>Ngày</th>
                        <th>Thứ</th>
                        <th>Thời gian</th>
                        <th>Nội dung chính</th>
                        <th>Nội dung chi tiết</th>
                        <th>Chủ trì/TPT</th>
                        <th>Thành phần</th>
                        <th>Địa điểm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody id="dataList" class="divide-y divide-gray-200">
                    <!-- Dữ liệu sẽ được chèn vào đây bởi JavaScript -->
                    <!-- Thông báo đang tải ban đầu -->
                    <tr><td colspan="9" class="text-center text-blue-500 p-8" id="initialLoadingMessage">Đang tải dữ liệu...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Thông báo khi không tìm thấy kết quả --><div id="noResults" class="hidden text-center text-gray-500 p-8 border border-dashed rounded-xl mt-6">
            Không tìm thấy kết quả phù hợp. Vui lòng thử lại.
        </div>
    </div>

    <script>
        // DỮ LIỆU TĨNH (MOCK DATA) - Đã loại bỏ lỗi tải dữ liệu từ Google Sheet.
        const allScheduleData = [
            { date: "01/12/2025", dayOfWeek: "Thứ 2", time: "7:30 SA", mainContent: "Chào cờ", detailedContent: "Chào cờ đầu tuần toàn trường", staff: "TPT", distribution: "Toàn Trường", location: "Sân trường", note: "TH" },
            { date: "01/12/2025", dayOfWeek: "Thứ 2", time: "7:45 SA", mainContent: "Trải nghiệm AI ROBOTICS", detailedContent: "Trải nghiệm AI ROBOTICS (L1/2, 1/1)", staff: "GVCN, QS", distribution: "Phòng AI ROBOTICS", location: "Phòng AI", note: "TH" },
            { date: "02/12/2025", dayOfWeek: "Thứ 3", time: "8:00 SA", mainContent: "Dự giờ thăm lớp", detailedContent: "Dự giờ thăm lớp đột xuất", staff: "BGH, TT", distribution: "Đột xuất", location: "Đột xuất", note: "TH" },
            { date: "02/12/2025", dayOfWeek: "Thứ 3", time: "4:00 CH", mainContent: "Phụ đạo", detailedContent: "Phụ đạo HS theo kế hoạch", staff: "TT", distribution: "GV được phân công", location: "Lớp học", note: "TH" },
            { date: "03/12/2025", dayOfWeek: "Thứ 4", time: "7:30 SA", mainContent: "Xem phim Mura đỏ", detailedContent: "Xem phim Mura đỏ: khối 1, khối 5, 3/1", staff: "TPT", distribution: "Cấp Tiểu học", location: "Hội trường A", note: "THCS" },
            { date: "04/12/2025", dayOfWeek: "Thứ 5", time: "9:30 SA", mainContent: "Tập huấn PCCC", detailedContent: "Tập huấn Phòng cháy chữa cháy cho giáo viên", staff: "PCCC", distribution: "Toàn bộ GV", location: "Hội trường B", note: "TH" },
            { date: "05/12/2025", dayOfWeek: "Thứ 6", time: "1:30 CH", mainContent: "Thi Olympic", detailedContent: "Tổ chức thi Olympic Toán cấp trường", staff: "Tổ Toán", distribution: "HS khối 4, 5", location: "Phòng Tin học", note: "TH" },
            { date: "06/12/2025", dayOfWeek: "Thứ 7", time: "7:30 SA", mainContent: "Họp PHHS", detailedContent: "Họp phụ huynh học sinh cuối học kỳ 1", staff: "BGH, GVCN", distribution: "Phụ huynh", location: "Sân trường", note: "THCS" },
        ];


        const dataList = document.getElementById('dataList');
        const searchInput = document.getElementById('searchInput');
        const noResults = document.getElementById('noResults');
        const tableBody = document.getElementById('dataList');

        // Hàm này giờ chỉ đơn giản là hiển thị dữ liệu tĩnh
        async function loadScheduleData() {
            // Xóa thông báo loading
            const loadingMessage = document.getElementById('initialLoadingMessage');
            if (loadingMessage) loadingMessage.remove(); 
            
            renderData();
        }


        // *************** PHẦN CÒN LẠI CỦA CODE KHÔNG THAY ĐỔI ***************

        /**
         * Tạo thẻ HTML cho một hàng bảng (table row).
         * @param {object} item - Đối tượng dữ liệu lịch công tác.
         * @param {number} index - Chỉ số của hàng để xác định màu xen kẽ.
         * @returns {string} - Chuỗi HTML của thẻ <tr>.
         */
        function createTableRow(item, index) {
            // Xác định màu nền xen kẽ cho các cột không có màu cố định (Thời gian, Nội dung chính, Nội dung chi tiết)
            const alternatingBg = (index % 2 === 0) ? 'bg-white' : 'bg-gray-50';

            // Màu nền cố định cho các cột dựa trên hình ảnh bảng tính:
            const colDateDayBg = 'bg-lime-100';      // Cột Ngày và Thứ: Xanh lá/Olive
            const colStaffDistLocBg = 'bg-sky-100'; // Cột Chủ trì, Thành phần, Địa điểm: Xanh dương nhạt/Cyan
            const colNoteBg = 'bg-green-100';       // Cột Ghi chú: Xanh lá nhạt

            // Màu chữ
            const dayText = 'text-blue-700 font-medium';
            const staffText = 'text-red-600 font-semibold';
            
            // Lớp hover chung cho hàng
            const rowHoverClass = 'hover:bg-gray-200';

            return `
                <tr class="transition duration-150 ease-in-out ${rowHoverClass}">
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-900 ${colDateDayBg}">${item.date}</td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm ${dayText} ${colDateDayBg}">${item.dayOfWeek}</td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-700 ${alternatingBg}">${item.time}</td>
                    <td class="px-3 py-2 text-sm text-gray-900 ${alternatingBg}">${item.mainContent}</td>
                    <td class="px-3 py-2 text-sm text-gray-600 ${alternatingBg}">${item.detailedContent}</td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm ${staffText} ${colStaffDistLocBg}">${item.staff}</td>
                    <td class="px-3 py-2 text-sm text-gray-700 ${colStaffDistLocBg}">${item.distribution}</td>
                    <td class="px-3 py-2 text-sm text-gray-700 ${colStaffDistLocBg}">${item.location}</td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-500 ${colNoteBg}">${item.note}</td>
                </tr>
            `;
        }

        /**
         * Lọc và hiển thị dữ liệu bảng.
         */
        function renderData() {
            const searchTerm = searchInput.value.toLowerCase().trim();

            // Lọc dữ liệu từ biến toàn cục đã tải
            const filteredData = allScheduleData.filter(item => {
                const searchString = `${item.date} ${item.dayOfWeek} ${item.time} ${item.mainContent} ${item.detailedContent} ${item.staff} ${item.distribution} ${item.location} ${item.note}`.toLowerCase();
                return searchString.includes(searchTerm);
            });

            // Sắp xếp dữ liệu theo ngày và thời gian (Sử dụng logic sắp xếp)
            filteredData.sort((a, b) => {
                const parseDate = (dateStr, timeStr) => {
                    const parts = dateStr.split('/');
                    if (parts.length !== 3) return 0;
                    const [day, month, year] = parts.map(Number);
                    const formattedTime = timeStr.replace('SA', ' AM').replace('CH', ' PM'); 
                    
                    try {
                        // Tên tháng bị thay đổi thành 0-11
                        return new Date(year, month - 1, day, formattedTime);
                    } catch (e) {
                        return new Date(0); 
                    }
                };
                
                try {
                    return parseDate(a.date, a.time) - parseDate(b.date, b.time);
                } catch (e) {
                    return 0;
                }
            });


            // Hiển thị hoặc thông báo không có kết quả
            if (filteredData.length === 0) {
                tableBody.innerHTML = '';
                noResults.classList.remove('hidden');
            } else {
                noResults.classList.add('hidden');
                // Sử dụng index của filteredData để đảm bảo màu xen kẽ chính xác
                tableBody.innerHTML = filteredData.map((item, index) => createTableRow(item, index)).join('');
            }
        }

        // Gắn sự kiện lắng nghe
        searchInput.addEventListener('input', renderData);

        // Hiển thị dữ liệu lần đầu tiên
        window.onload = function() {
            // Khởi tạo tải dữ liệu
            loadScheduleData(); 
            
            // Đã loại bỏ setInterval vì dữ liệu là tĩnh
        }

    </script>
</body>
</html>
